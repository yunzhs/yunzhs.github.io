---
layout:     post
title:      秒杀系统简单的业务逻辑和实现
subtitle:   
date:       2017-09-4
author:     yunzhs
header-img: img/SMILE.jpg
catalog: true
tags:
    - 业务操作
typora-root-url: ..
typora-copy-images-to: ..\img\posts
---

## 秒杀业务分析

### 需求分析

​	所谓“秒杀”，就是网络[卖家](https://baike.baidu.com/item/%E5%8D%96%E5%AE%B6)发布一些超低价格的商品，所有买家在同一时间网上抢购的一种销售方式。通俗一点讲就是网络商家为促销等目的组织的网上限时抢购活动。由于商品价格低廉，往往一上架就被抢购一空，有时只用一秒钟。

​	秒杀商品通常有两种限制：库存限制、时间限制。

​	需求:

​	（1）商家提交秒杀商品申请，录入秒杀商品数据，主要包括：商品标题、原价、秒杀价、商品图片、介绍等信息

​	（2）运营商审核秒杀申请

​	（3）秒杀频道首页列出秒杀商品（进行中的）点击秒杀商品图片跳转到秒杀商品详细页。

​	（4）商品详细页显示秒杀商品信息，点击立即抢购实现秒杀下单，下单时扣减库存。当库存为0或不在活动期范围内时无法秒杀。

​	（5）秒杀下单成功，直接跳转到支付页面（微信扫码），支付成功，跳转到成功页，填写收货地址、电话、收件人等信息，完成订单。

​	（6）当用户秒杀下单5分钟内未支付，取消预订单，调用微信支付的关闭订单接口，恢复库存。



## 秒杀技术核心思想

​	秒杀技术实现核心思想是运用缓存减少数据库瞬间的访问压力！读取商品详细信息时运用缓存，当用户点击抢购时减少缓存中的库存数量，当库存数为0时或活动期结束时，同步到数据库。 产生的秒杀预订单也不会立刻写到数据库中，而是先写到缓存，当用户付款成功后再写入数据库。



## 秒杀实现实际问题和解决方案

### 1.难点

(1). 秒杀之所以挂掉,是因为请求都到了DB层,减少数据库瞬间的访问压力,把请求拦截在上游(前端,web,service)

(2). 典型的读多写少的场景,使用redis缓存可以大大的减轻压力

### 2.解决方案

(1).商品页面中的购买按钮只有在秒杀活动开始的时候的才会变亮,在此之前及秒杀商品卖出去后,按钮都是灰的

(2).增加网络带宽,减少秒杀详情页文件大小

(3).使用秒杀专用验证码,电视上公布验证码秒杀答题,分时段秒杀

(4).读取秒杀商品列表和秒杀商品详情页时,都是从redis高速缓存中读取

(5)**.秒杀商品的减库存的操作**不在数据中进行,而在redis中进行操作


